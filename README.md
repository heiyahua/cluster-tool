# cluster-tool
智能簇划分工具
智能簇划分工具
版本号：V1.0
日期：2025年8月14日
________________________________________
目录
1.	软件概述
2.	背景与开发目的
3.	功能规格说明
4.	系统设计
5.	核心算法原理
6.	模块说明与接口设计
7.	程序运行流程
8.	用户手册
9.	测试与验证
10.	结论与展望
附录
________________________________________
1. 软件概述
智能簇划分工具是一款基于 Python 语言开发的电信网络数据处理与聚类分析软件，主要用于大规模基站数据的自动化处理和聚类分析，满足网络规划和优化的需求。
该工具具备数据读取、编码识别、数据展开与拆分、基于空间位置和业务逻辑的聚类、结果合并与排名、可视化界面操作等全流程功能。
软件采用 PyQt5 作为图形化界面框架，结合 pandas、numpy、scipy 等高性能数据处理与科学计算库，能够在短时间内完成百万级数据行的分析任务。
________________________________________
2. 背景与开发目的
在电信网络优化过程中，经常需要根据基站的地理位置和业务标识（如 C-RAN）将基站划分为若干“簇”，以便进行网络规划、传输设计和资源分配。
传统人工划分方法效率低、容易出错，且在数据量庞大时几乎无法完成。
本软件的开发目标是：
1.	自动化：将从原始数据导入到簇划分完成的整个过程自动化。
2.	高性能：利用 KDTree 空间索引和并行处理方法，快速完成大规模数据的邻近搜索与聚类。
3.	易用性：通过图形化界面让非编程人员也能使用。
4.	可扩展性：为后续引入更多聚类算法和可视化功能留有扩展空间。
________________________________________
3. 功能规格说明
3.1 核心功能
•	数据导入：支持 CSV 格式，自动识别编码（GBK、GB2312、UTF-8）。
•	数据展开：按“小区数量”字段将基站记录展开为单个小区级别的行。
•	数据拆分：按地市或传输汇聚环字段拆分为多个子文件，便于并行处理。
•	聚类计算：
o	基于 Haversine 公式计算地理距离。
o	使用 KDTree 快速检索近邻基站。
o	结合 C-RAN 阈值进行优先聚类。
o	控制簇内最大小区数与最大基站数。
•	结果生成：
o	生成簇编号、唯一簇编号、地市簇编号。
o	统计簇内小区数量、基站数量。
o	计算簇内基站流量排名与簇流量排名（如有流量数据）。
•	文件输出：导出 CSV/Excel 文件，编码为 GBK 便于在国内环境下使用。
3.2 输入输出
输入文件字段示例：
地市, 基站ID, 小区数量, 经度, 纬度, C-RAN标识, 传输汇聚环
输出文件：
•	簇明细-*.csv：包含每个小区的簇编号、统计信息。
•	排名结果.xlsx：按地市簇编号排序的聚类结果表。
________________________________________
4. 系统设计
4.1 系统结构
系统由六大模块组成：
1.	文件读取与编码检测模块
2.	数据预处理模块（展开、拆分）
3.	基于 KDTree 的聚类计算模块
4.	结果合并与排名模块
5.	用户界面模块（PyQt5）
6.	日志与进度显示模块
 
________________________________________
5. 核心算法原理
5.1 距离计算
采用 Haversine 公式计算地球球面两点之间的距离：
d=2R⋅arcsin⁡(sin⁡2Δφ2+cos⁡φ1cos⁡φ2sin⁡2Δλ2)d = 2R \cdot \arcsin \left( \sqrt{\sin^2\frac{\Delta\varphi}{2} + \cos\varphi_1 \cos\varphi_2 \sin^2\frac{\Delta\lambda}{2}} \right)d=2R⋅arcsin(sin22Δφ+cosφ1cosφ2sin22Δλ) 
其中 RRR 为地球半径（6371000 米），φ\varphiφ 为纬度，λ\lambdaλ 为经度。
5.2 KDTree 加速
利用 KDTree 数据结构将所有基站的经纬度坐标建立空间索引，在邻居搜索时大幅降低时间复杂度（O(log N)）。
5.3 聚类策略
•	Step 1：选取未访问的基站作为种子。
•	Step 2：优先添加与种子同 C-RAN 且数量≥阈值的基站。
•	Step 3：补充 C-RAN 为空的近邻基站。
•	Step 4：补充其它未访问的近邻基站，直至簇内小区数与基站数达到限制。
________________________________________
6. 模块说明与接口设计
模块	核心函数	功能描述
文件读取与编码检测	detect_encoding	检测文件编码并返回可用编码字符串
数据展开模块	expand_by_cell_count	按小区数量展开基站记录
数据拆分模块	split_csv_by_city	按城市或传输汇聚环拆分数据
聚类计算模块	cluster_city_files	核心聚类逻辑
结果合并模块	merge_cluster_results	合并所有城市的聚类结果并计算排名
界面模块	ClusterApp	提供 PyQt5 图形化操作界面
________________________________________
7. 程序运行流程
（此处插入《程序流程图》）
流程描述：
1.	用户选择原始数据文件。
2.	系统检测编码并读取数据。
3.	按小区数量展开基站记录。
4.	按地市/传输汇聚环拆分文件。
5.	对每个子文件执行 KDTree 邻居搜索与聚类。
6.	合并所有结果并生成排名。
7.	导出结果文件。
________________________________________
8. 用户手册
8.1 安装步骤
1.	安装 Python 3.8+。
2.	运行命令：
3.	pip install pandas numpy scipy pyqt5 tqdm chardet openpyxl
4.	下载软件源代码并保存到本地。
8.2 使用方法
1.	双击运行 python 智能簇划分工具.py 启动界面。
2.	在“文件选择”处选择输入 CSV 文件。
3.	根据需求调整聚类参数。
4.	点击“开始执行”按钮运行。
5.	等待进度条完成，查看输出目录的结果文件。
8.3 界面说明
•	文件选择区：选择输入数据文件。
•	参数区：设置簇划分参数（小区数、基站数、C-RAN 阈值等）。
•	日志区：实时显示处理过程。
•	进度条：显示执行进度百分比。
________________________________________
9. 测试与验证
测试环境：
•	操作系统：Windows 10
•	CPU：Intel i7
•	内存：16 GB
•	Python：3.9
测试数据：
•	某省移动基站数据（10 万行）
测试结果：
•	数据读取成功率 100%
•	聚类结果准确率 100%（与人工结果比对）
•	平均处理时间 10分钟/10 万行
________________________________________
10. 结论与展望
智能簇划分工具实现了高效、准确的基站数据聚类处理，极大提升了网络规划和优化的效率。
未来将加入以下功能：
•	更多聚类算法选择（DBSCAN、KMeans）。
•	聚类结果地图可视化。
•	支持更多数据输入格式（Excel、数据库连接）。
________________________________________
附录
示例输入数据：
地市, 基站ID, 小区数量, 经度, 纬度, C-RAN标识, 传输汇聚环
依赖库：
pandas, numpy, scipy, pyqt5, tqdm, chardet, openpyxl

